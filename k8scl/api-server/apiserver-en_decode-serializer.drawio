<mxfile host="65bd71144e">
    <diagram id="ZacawW71OSz3Lvz-_CWl" name="第 1 页">
        <mxGraphModel dx="4393" dy="4193" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" background="#E6E6E6" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="2" value="&lt;span style=&quot;color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Segoe UI Emoji&amp;quot;, sans-serif; font-size: 40px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 4; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;Serializer 的加载和使用&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=40;fontFamily=Architects Daughter;" vertex="1" parent="1">
                    <mxGeometry x="-129" y="71" width="434" height="59" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="1. 做一个 reqScope" style="text;strokeColor=none;fillColor=none;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=26;" vertex="1" parent="1">
                    <mxGeometry x="-204" y="346" width="406" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="2. 在制作 req handler 的时候，使用上面的 reqScope" style="text;strokeColor=none;fillColor=none;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=26;" vertex="1" parent="1">
                    <mxGeometry x="-124" y="1333" width="667" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="3. 在 handler 内使用 Serializer 得到 encoder/decoder 进行编解码" style="text;strokeColor=none;fillColor=none;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=26;" vertex="1" parent="1">
                    <mxGeometry x="1218" y="346" width="799" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="&lt;div style=&quot;color: rgb(255, 255, 255); background-color: rgb(32, 40, 49); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-weight: normal; font-size: 20px; line-height: 27px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;reqScope &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; handlers.RequestScope{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Serializer: &amp;nbsp; &amp;nbsp; &amp;nbsp;a.group.Serializer,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ParameterCodec: &amp;nbsp;a.group.ParameterCodec,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Creater: &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; a.group.Creater,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Convertor: &amp;nbsp; &amp;nbsp; &amp;nbsp; a.group.Convertor,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Defaulter: &amp;nbsp; &amp;nbsp; &amp;nbsp; a.group.Defaulter,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Typer: &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; a.group.Typer,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; UnsafeConvertor: a.group.UnsafeConvertor,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Authorizer: &amp;nbsp; &amp;nbsp; &amp;nbsp;a.group.Authorizer,&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; EquivalentResourceMapper: a.group.EquivalentResourceRegistry,&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #55616c;font-style: italic;&quot;&gt;// TODO: Check for the interface on storage&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; TableConvertor: tableProvider,&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #55616c;font-style: italic;&quot;&gt;// TODO: This seems wrong for cross-group subresources. It makes an assumption that a subresource and its parent are in the same group version. Revisit this.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Resource: &amp;nbsp; &amp;nbsp;a.group.GroupVersion.WithResource(resource),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Subresource: subresource,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Kind: &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;fqKindToRegister,&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; AcceptsGroupVersionDelegate: gvAcceptor,&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; HubGroupVersion: schema.GroupVersion{Group: fqKindToRegister.Group, Version: runtime.APIVersionInternal},&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; MetaGroupVersion: metav1.SchemeGroupVersion,&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; MaxRequestBodyBytes: a.group.MaxRequestBodyBytes,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;fontSize=26;fontFamily=Architects Daughter;" vertex="1" parent="1">
                    <mxGeometry x="-124.00000000000001" y="445" width="1271.67" height="786.78" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="&lt;div style=&quot;color: rgb(255, 255, 255); background-color: rgb(32, 40, 49); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-weight: normal; font-size: 20px; line-height: 27px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;POST&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #55616c;font-style: italic;&quot;&gt;// Create a resource.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;var&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; handler restful.RouteFunction&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; isNamedCreater {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; handler &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; restfulCreateNamedResource(namedCreater, reqScope, admit)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; handler &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; restfulCreateResource(creater, reqScope, admit)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; handler &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; metrics.InstrumentRouteFunc(action.Verb, group, version, resource, subresource, requestScope, metrics.APIServerComponent, deprecated, removedRelease, handler)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; handler &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; utilwarning.AddWarningsHandler(handler, warnings)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; article &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; GetArticleForNoun(kind, &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; doc &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;create&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; article &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; kind&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; isSubresource {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; doc &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;create &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; subresource &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt; of&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; article &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; kind&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;fontSize=26;fontFamily=Architects Daughter;" vertex="1" parent="1">
                    <mxGeometry x="-124" y="1434" width="1271" height="418" as="geometry"/>
                </mxCell>
                <mxCell id="9" value="vendor/k8s.io/apiserver/pkg/endpoints/installer.go:registerResourceHandlers" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9B2;strokeColor=none;fillStyle=solid;direction=west;gradientDirection=north;gradientColor=#FFF2A1;shadow=1;size=20;pointerEvents=1;hachureGap=4;fontFamily=Lucida Console;fontSize=26;" vertex="1" parent="1">
                    <mxGeometry x="-124" y="268" width="1213" height="61" as="geometry"/>
                </mxCell>
                <mxCell id="10" value="vendor/k8s.io/apiserver/pkg/endpoints/handlers/create.go:CreateHadnler()[update 等都有]" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9B2;strokeColor=none;fillStyle=solid;direction=west;gradientDirection=north;gradientColor=#FFF2A1;shadow=1;size=20;pointerEvents=1;hachureGap=4;fontFamily=Lucida Console;fontSize=26;" vertex="1" parent="1">
                    <mxGeometry x="1210" y="268" width="1390" height="61" as="geometry"/>
                </mxCell>
                <mxCell id="11" value="&lt;div style=&quot;color: rgb(255, 255, 255); background-color: rgb(32, 40, 49); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-weight: normal; font-size: 20px; line-height: 27px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;func&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #ffc66d;&quot;&gt;createHandler&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;(r rest.NamedCreater, scope &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;RequestScope, admit admission.Interface, includeName &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;bool&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;) http.HandlerFunc {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;func&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;(w http.ResponseWriter, req &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;http.Request) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #55616c;font-style: italic;&quot;&gt;// For performance tracking purposes.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; trace &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; utiltrace.New(&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;Create&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;, traceFields(req)&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;defer&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; trace.LogIfLong(&lt;/span&gt;&lt;span style=&quot;color: #f9846c;&quot;&gt;500&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; time.Millisecond)&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; isDryRun(req.URL) &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;utilfeature.DefaultFeatureGate.Enabled(features.DryRun) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(errors.NewBadRequest(&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;the dryRun feature is disabled&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;), w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; namespace, name, err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; scope.Namer.Name(req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; nil {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; includeName {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #55616c;font-style: italic;&quot;&gt;// name was required, return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(err, w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #55616c;font-style: italic;&quot;&gt;// otherwise attempt to look up the namespace&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; namespace, err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; scope.Namer.Namespace(req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; nil {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(err, w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #55616c;font-style: italic;&quot;&gt;// enforce a timeout of at most requestTimeoutUpperBound (34s) or less if the user-provided&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #55616c;font-style: italic;&quot;&gt;// timeout inside the parent context is lower than requestTimeoutUpperBound.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ctx, cancel &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; context.WithTimeout(req.Context(), requestTimeoutUpperBound)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;defer&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; cancel()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; outputMediaType, _, err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; negotiation.NegotiateOutputMediaType(req, scope.Serializer, scope)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; nil {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(err, w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; gv &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; scope.Kind.GroupVersion()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; s, err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; negotiation.NegotiateInputSerializer(req, false, scope.Serializer)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; nil {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(err, w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; body, err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; limitedReadBody(req, scope.MaxRequestBodyBytes)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; nil {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(err, w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; options &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;metav1.CreateOptions{}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; values &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; req.URL.Query()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; metainternalversionscheme.ParameterCodec.DecodeParameters(values, scope.MetaGroupVersion, options); err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; nil {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; errors.NewBadRequest(err.Error())&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(err, w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; errs &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; validation.ValidateCreateOptions(options); len(errs) &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #f9846c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; errors.NewInvalid(schema.GroupKind{Group: metav1.GroupName, Kind: &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;CreateOptions&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;}, &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;, errs)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(err, w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; options.TypeMeta.SetGroupVersionKind(metav1.SchemeGroupVersion.WithKind(&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;CreateOptions&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; defaultGVK &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; scope.Kind&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; original &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; r.New()&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; validationDirective &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; fieldValidation(options.FieldValidation)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; decodeSerializer &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; s.Serializer&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; validationDirective &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; metav1.FieldValidationWarn &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;||&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; validationDirective &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; metav1.FieldValidationStrict {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; decodeSerializer &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; s.StrictSerializer&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; decoder &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; scope.Serializer.DecoderToVersion(decodeSerializer, scope.HubGroupVersion)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; trace.Step(&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;About to convert to expected version&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; obj, gvk, err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; decoder.Decode(body, &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;defaultGVK, original)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; nil {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; strictError, isStrictError &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; runtime.AsStrictDecodingError(err)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;switch&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; isStrictError &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; obj &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; nil &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; validationDirective &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; metav1.FieldValidationWarn:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; addStrictDecodingWarnings(req.Context(), strictError.Errors())&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; isStrictError &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; validationDirective &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; metav1.FieldValidationIgnore:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; klog.Warningf(&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #3d8beb;&quot;&gt;unexpected strict error when field validation is set to ignore&lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;fallthrough&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;default&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; err &lt;/span&gt;&lt;span style=&quot;color: #40bf77;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt; transformDecodeError(scope.Typer, err, original, gvk, body)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; scope.err(err, w, req)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #ff92bb;font-weight: bold;&quot;&gt;return&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #ffffff;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;fontSize=26;fontFamily=Lucida Console;" vertex="1" parent="1">
                    <mxGeometry x="1218" y="445" width="1442" height="2439" as="geometry"/>
                </mxCell>
                <mxCell id="18" value="Text" style="text;strokeColor=none;fillColor=none;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="940" y="431" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;labelBorderColor=#FF3333;fontColor=#FF3333;fillColor=none;strokeWidth=2;dashed=1;strokeColor=#FF3333;" vertex="1" parent="1">
                    <mxGeometry x="1333" y="2339" width="448" height="31" as="geometry"/>
                </mxCell>
                <mxCell id="20" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;labelBorderColor=#FF3333;fontColor=#FF3333;fillColor=none;strokeWidth=2;dashed=1;strokeColor=#FF3333;" vertex="1" parent="1">
                    <mxGeometry x="1303" y="2286" width="364" height="31" as="geometry"/>
                </mxCell>
                <mxCell id="21" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;labelBorderColor=#FF3333;fontColor=#FF3333;fillColor=none;strokeWidth=2;dashed=1;strokeColor=#FF3333;" vertex="1" parent="1">
                    <mxGeometry x="2004" y="1285" width="364" height="31" as="geometry"/>
                </mxCell>
                <mxCell id="22" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;labelBorderColor=#FF3333;fontColor=#FF3333;fillColor=none;strokeWidth=2;dashed=1;strokeColor=#FF3333;" vertex="1" parent="1">
                    <mxGeometry x="1306" y="2422" width="935" height="31" as="geometry"/>
                </mxCell>
                <mxCell id="23" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;labelBorderColor=#FF3333;fontColor=#FF3333;fillColor=none;strokeWidth=2;dashed=1;strokeColor=#FF3333;" vertex="1" parent="1">
                    <mxGeometry x="-39" y="477" width="442" height="31" as="geometry"/>
                </mxCell>
                <mxCell id="24" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;fontColor=#FF3333;endArrow=open;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;curved=1;shape=link;" edge="1" parent="1">
                    <mxGeometry width="140" relative="1" as="geometry">
                        <mxPoint x="-129" y="197" as="sourcePoint"/>
                        <mxPoint x="2752" y="197" as="targetPoint"/>
                        <Array as="points"/>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>