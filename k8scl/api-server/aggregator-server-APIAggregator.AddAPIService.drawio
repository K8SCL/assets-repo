<mxfile host="65bd71144e">
    <diagram id="DR6rLCBzBc7HwvmwE_sy" name="第 1 页">
        <mxGraphModel dx="2610" dy="1124" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="12" value="" style="group" vertex="1" connectable="0" parent="1">
                    <mxGeometry x="211" y="-15" width="593" height="134" as="geometry"/>
                </mxCell>
                <mxCell id="10" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=none;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;fontColor=#000000;strokeColor=none;" vertex="1" parent="12">
                    <mxGeometry width="593" height="134" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="&lt;font color=&quot;#000000&quot;&gt;最终是由&amp;nbsp;staging/src/k8s.io/kube-aggregator/pkg/apiserver/handler_proxy.go:&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;background-color: rgb(32 , 40 , 49) ; color: rgb(255 , 255 , 255) ; font-family: &amp;#34;jetbrains mono&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace&quot;&gt;proxyHandler.&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;jetbrains mono&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace&quot;&gt;&lt;font color=&quot;#ffc66d&quot; style=&quot;background-color: rgb(32 , 40 , 49)&quot;&gt;ServeHTTP()&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;来处理的，所以这里会生成该结构体，并赋给响应 url&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="text;strokeColor=none;fillColor=none;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;fontColor=#409EFF;" vertex="1" parent="12">
                    <mxGeometry x="11" y="42" width="433" height="83" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="制作 /apis/&amp;lt;group&amp;gt;/&amp;lt;version&amp;gt;/ 开头的请求和响应函数" style="text;strokeColor=none;fillColor=none;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;fontColor=#409EFF;" vertex="1" parent="12">
                    <mxGeometry x="11" y="9" width="453" height="31" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="" style="group;strokeColor=none;" vertex="1" connectable="0" parent="1">
                    <mxGeometry x="-456" y="96" width="561" height="106" as="geometry"/>
                </mxCell>
                <mxCell id="13" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=none;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;fontColor=#000000;strokeColor=#FF9933;" vertex="1" parent="14">
                    <mxGeometry width="561" height="106" as="geometry"/>
                </mxCell>
                <mxCell id="2" value="staging/src/k8s.io/kube-aggregator/pkg/apiserver/apiserver.go:&lt;br&gt;&lt;div style=&quot;color: rgb(255 , 255 , 255) ; background-color: rgb(32 , 40 , 49) ; font-family: &amp;#34;jetbrains mono&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; font-size: 16px ; line-height: 22px&quot;&gt;&lt;div style=&quot;line-height: 22px&quot;&gt;(s &lt;span style=&quot;color: #40bf77&quot;&gt;*&lt;/span&gt;APIAggregator) &lt;span style=&quot;color: #ffc66d&quot;&gt;AddAPIService()&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=20;" vertex="1" parent="14">
                    <mxGeometry x="9" y="12" width="523" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="15" value="" style="group" vertex="1" connectable="0" parent="1">
                    <mxGeometry x="211" y="170" width="593" height="134" as="geometry"/>
                </mxCell>
                <mxCell id="16" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=none;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;fontColor=#000000;strokeColor=none;" vertex="1" parent="15">
                    <mxGeometry width="593" height="134" as="geometry"/>
                </mxCell>
                <mxCell id="17" value="&lt;span style=&quot;font-family: &amp;#34;jetbrains mono&amp;#34; , &amp;#34;consolas&amp;#34; , &amp;#34;courier new&amp;#34; , monospace&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;用于响应对 &lt;/font&gt;&lt;font color=&quot;#ff9933&quot;&gt;/apis/&amp;lt;group&amp;gt; &lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;的请求&lt;br&gt;返回结果是由该 group 下的所有 version 的集合&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="text;strokeColor=none;fillColor=none;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;fontColor=#409EFF;" vertex="1" parent="15">
                    <mxGeometry x="11" y="42" width="433" height="83" as="geometry"/>
                </mxCell>
                <mxCell id="18" value="制作 Version Discovery Request 的 Handler" style="text;strokeColor=none;fillColor=none;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;fontColor=#409EFF;" vertex="1" parent="15">
                    <mxGeometry x="11" y="9" width="453" height="31" as="geometry"/>
                </mxCell>
                <mxCell id="19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Lucida Console;fontSize=16;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="13" target="10">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Lucida Console;fontSize=16;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="13" target="16">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="22" value="ServeHTTP" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=none;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=24;fontColor=#000000;strokeColor=#FF9933;" vertex="1" parent="1">
                    <mxGeometry x="-456" y="504" width="375" height="105" as="geometry"/>
                </mxCell>
                <mxCell id="23" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelBackgroundColor=none;sketch=0;hachureGap=4;fontFamily=Lucida Console;fontSize=24;fontColor=#000000;strokeColor=#000000;" vertex="1" parent="1">
                    <mxGeometry x="-81" y="423" width="86" height="270" as="geometry"/>
                </mxCell>
                <mxCell id="28" value="如果是本地的 Server （Master 和 Extension） 支持的 API Resource，交给 delegationServer 去处理" style="text;strokeColor=none;fillColor=none;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=none;sketch=0;hachureGap=4;fontFamily=Lucida Console;fontSize=18;fontColor=#000000;" vertex="1" parent="1">
                    <mxGeometry x="16" y="407" width="450" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="29" value="其余的 request 需要 Custom Server 响应，制作 http client，去请求对应的 server。这里一定会涉及到证书的问题" style="text;strokeColor=none;fillColor=none;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=none;sketch=0;hachureGap=4;fontFamily=Lucida Console;fontSize=18;fontColor=#000000;" vertex="1" parent="1">
                    <mxGeometry x="10" y="647" width="420" height="80" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>