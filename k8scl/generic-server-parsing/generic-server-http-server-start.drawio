<mxfile host="65bd71144e">
    <diagram id="CRo-DTNcsTOz1Pmc8UAz" name="第 1 页">
        <mxGraphModel dx="4537" dy="3026" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="16" style="edgeStyle=none;curved=1;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Lucida Console;fontSize=16;fontColor=#FFB366;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="2" target="12">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="31" value="等待上面流程完毕" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=16;fontFamily=Lucida Console;fontColor=#66B2FF;" vertex="1" connectable="0" parent="16">
                    <mxGeometry x="-0.1849" relative="1" as="geometry">
                        <mxPoint y="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="21" style="edgeStyle=none;curved=1;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;fontColor=#FFB366;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="2" target="3">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="2" value="&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;font data-font-src=&quot;https://fonts.googleapis.com/css?family=Permanent+Marker&quot; face=&quot;Lucida Console&quot; style=&quot;font-size: 16px&quot;&gt;cmd/kube-apiserver/app/server.go:&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;font data-font-src=&quot;https://fonts.googleapis.com/css?family=Permanent+Marker&quot; face=&quot;Lucida Console&quot; style=&quot;font-size: 16px&quot;&gt;&lt;font color=&quot;#ffb366&quot; style=&quot;font-size: 16px&quot;&gt;Run()&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;" style="rounded=0;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;strokeColor=#FFB366;" vertex="1" parent="1">
                    <mxGeometry x="-1641" y="-319" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="20" style="edgeStyle=none;curved=1;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;fontColor=#FFB366;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="3" target="10">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;font data-font-src=&quot;https://fonts.googleapis.com/css?family=Permanent+Marker&quot; face=&quot;Lucida Console&quot; style=&quot;font-size: 16px&quot;&gt;vendor/k8s.io/kube-aggregator/pkg/apiserver/apiserver.go:&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;font data-font-src=&quot;https://fonts.googleapis.com/css?family=Permanent+Marker&quot; face=&quot;Lucida Console&quot; style=&quot;font-size: 16px&quot;&gt;&lt;font color=&quot;#ffb366&quot; style=&quot;font-size: 16px&quot;&gt;*APIAggregator.PrepareRun()&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;" style="rounded=0;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;strokeColor=#FFB366;" vertex="1" parent="1">
                    <mxGeometry x="-910" y="-319" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="10" value="&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;vendor/k8s.io/kubeaggregator/pkg/server/genericapiserver.go&lt;/span&gt;&lt;span style=&quot;font-size: 16px ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;span style=&quot;color: rgb(255 , 179 , 102) ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;*GenericAPIServer.PrepareRun()&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="rounded=0;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;strokeColor=#FFB366;" vertex="1" parent="1">
                    <mxGeometry x="-179" y="-319" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="22" style="edgeStyle=none;curved=1;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;fontColor=#FFB366;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="12" target="13">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;vendor/k8s.io/kube-aggregator/pkg/apiserver/&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;apiserver&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;.go&lt;/span&gt;&lt;span style=&quot;font-size: 16px ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;span style=&quot;color: rgb(255 , 179 , 102) ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;*preparedAPIAggregator.Run()&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="rounded=0;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;strokeColor=#FFB366;" vertex="1" parent="1">
                    <mxGeometry x="-1641" y="41" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="24" style="edgeStyle=none;curved=1;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Lucida Console;fontSize=16;fontColor=#66B2FF;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;exitX=1;exitY=0.538;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="13" target="14">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="13" value="&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;vendor/k8s.io/apiserver/pkg/server/genericapiserver.go&lt;/span&gt;&lt;span style=&quot;font-size: 16px ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;span style=&quot;color: rgb(255 , 179 , 102) ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;*preparedGenericAPIServer.Run()&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="rounded=0;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;strokeColor=#FFB366;" vertex="1" parent="1">
                    <mxGeometry x="-910" y="36" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="27" style="edgeStyle=none;curved=1;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;fontFamily=Lucida Console;fontSize=16;fontColor=#66B2FF;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="14" target="15">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;vendor/k8s.io/apiserver/pkg/server/genericapiserver.go&lt;/span&gt;&lt;span style=&quot;font-size: 16px ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;span style=&quot;color: rgb(255 , 179 , 102) ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;*preparedGenericAPIServer.NonBlockingRun()&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="rounded=0;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;strokeColor=#FFB366;" vertex="1" parent="1">
                    <mxGeometry x="-179" y="39" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="15" value="&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;vendor/k8s.io/apiserver/pkg/server/secure_serving.go&lt;/span&gt;&lt;span style=&quot;font-size: 16px ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;lucida console&amp;#34; ; font-size: 16px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;font-size: 16px&quot;&gt;&lt;span style=&quot;color: rgb(255 , 179 , 102) ; font-family: &amp;#34;lucida console&amp;#34;&quot;&gt;*SecureServingInfo.Serve()&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="rounded=0;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;strokeColor=#FFB366;" vertex="1" parent="1">
                    <mxGeometry x="-179" y="316" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="17" value="啥也没干，直接去调用下一个方法" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9B2;strokeColor=none;fillStyle=solid;direction=west;gradientDirection=north;gradientColor=#FFF2A1;shadow=1;size=20;pointerEvents=1;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;" vertex="1" parent="1">
                    <mxGeometry x="-1645" y="133" width="386" height="108" as="geometry"/>
                </mxCell>
                <mxCell id="18" value="注册 openapi 相关的 controller 到 post start hook 中" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9B2;strokeColor=none;fillStyle=solid;direction=west;gradientDirection=north;gradientColor=#FFF2A1;shadow=1;size=20;pointerEvents=1;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;" vertex="1" parent="1">
                    <mxGeometry x="-906" y="-232" width="393" height="82" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="制作 openapi，server healthz，livez,readyz 等 endpoints" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9B2;strokeColor=none;fillStyle=solid;direction=west;gradientDirection=north;gradientColor=#FFF2A1;shadow=1;size=20;pointerEvents=1;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;" vertex="1" parent="1">
                    <mxGeometry x="-179" y="-232" width="393" height="82" as="geometry"/>
                </mxCell>
                <mxCell id="23" value="编织出 server 生命周期中的状态流转（利用 channel 机制）；关闭开始前调用 &lt;font color=&quot;#66b2ff&quot;&gt;pre shutdown hooks&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9B2;strokeColor=none;fillStyle=solid;direction=west;gradientDirection=north;gradientColor=#FFF2A1;shadow=1;size=20;pointerEvents=1;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;" vertex="1" parent="1">
                    <mxGeometry x="-910" y="131" width="393" height="82" as="geometry"/>
                </mxCell>
                <mxCell id="28" value="触发启动 http server，启动后触发 &lt;font color=&quot;#66b2ff&quot;&gt;post start hooks&lt;/font&gt; 的执行" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9B2;strokeColor=none;fillStyle=solid;direction=west;gradientDirection=north;gradientColor=#FFF2A1;shadow=1;size=20;pointerEvents=1;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;" vertex="1" parent="1">
                    <mxGeometry x="-179" y="131" width="393" height="82" as="geometry"/>
                </mxCell>
                <mxCell id="30" style="edgeStyle=none;curved=1;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Lucida Console;fontSize=16;fontColor=#66B2FF;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="29" target="15">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="29" value="HTTP2.0，TLS 设置，启动 Server" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9B2;strokeColor=none;fillStyle=solid;direction=west;gradientDirection=north;gradientColor=#FFF2A1;shadow=1;size=20;pointerEvents=1;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=16;" vertex="1" parent="1">
                    <mxGeometry x="-415" y="318.5" width="193" height="75" as="geometry"/>
                </mxCell>
                <mxCell id="32" value="&lt;div style=&quot;font-family: consolas, &amp;quot;courier new&amp;quot;, monospace; line-height: 29px; font-size: 40px;&quot;&gt;&lt;font style=&quot;background-color: rgb(255, 255, 255); font-size: 40px;&quot; color=&quot;#000000&quot;&gt;&lt;b style=&quot;font-size: 40px;&quot;&gt;HTTP Server 的启动&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=1;hachureGap=4;fontFamily=Lucida Console;fontSize=40;fontColor=#66B2FF;fontStyle=2;horizontal=1;" vertex="1" parent="1">
                    <mxGeometry x="-1641" y="-481" width="413" height="98" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>